# golang

## defer

### defer 实现机制

在面试问到了 defer 的时候，你要主动回答这些内容。它能让你拉开和面试者的差距。

defer 的内部实现分成三种机制：

• **堆上分配**：是指整个 defer 直接分配到堆上，缺点就是要被 GC 管理。
• **栈上分配**：整个 defer 分配到了 goroutine 栈上，不需要被 GC 管理。比堆上分配性能提升了
30%。
• **开放编码**（Open Code）：启用内联的优化，你直观理解就是相当于把你的 defer 内容放到
了你的函数最后。启用条件：
• 函数的 defer 数量少于或者等于 8 个；
• 函数的 defer 关键字不能在循环中执行；
• 函数的 return 语句与 defer 语句的乘积小于或者等于 15 个。

### 面试思路

你的回答要分成几个部分：
• defer 的作用
• defer 的底层实现原理。这算是你在初级工程师面试中刷亮点的地方：
• 堆上分配与栈上分配：这个地方你要尝试引导到内存逃逸、GO 性能优化这种话题上。
• 开放编码。



# MySQL

# Redis

Redis 面试题目
• 你用 Redis 解决过什么问题？
• 你知道 Redis 支持哪些数据结构吗？你用过哪些？用来解决什么问题？
• Redis 各个数据结构的底层实现？
• 当你更新数据的时候，你先更新数据库，还是先更新缓存？有没有一致性问题？
• 如何解决一致性问题？

# 计算机网络



# 操作系统

# 其他

## gin

**实际上，Gin 作为简单的框架，能够面试的内容并不多。**
• 什么是 Gin 的 middleware？能用来解决什么问题？
• 什么是跨域问题，怎么解决？
• 跨域问题需要设置哪些头部？
在 Gin 面试的时候，一定要提起自己研发了一个强大 Gin 插件库。

## session

• 什么是 Cookie，什么是 Session？
• Cookie 和 Session 比起来有什么缺点？
• Session ID 可以放在哪里？这个问题，你要记得提起 Cookie 禁用的问题。
• 用户密码加密算法选取有什么注意事项？你用的是什么？
• 怎么做登录校验？核心是利用 Gin 的 middleware。

## session深入

• 刷新 Session 过期时间的几种可行的办法，你要能够深入分析不同做法的优缺点。注意，面试不是实
践，不能说我记住最佳的就行，而是你要尽可能”水“时间，展示自己博闻广识。
• 增强登录的安全性：
• 怎么保护 Session id？主要还是要启用 HTTPS 协议，把 Cookie 的 Secure 和 HttpOnly 都设置为
true。
• 怎么做到在 Session id 或者 JWT token 泄露之后保护住用户？要在登录的时候记录一下登录的附
加信息，例如 User-Agent，在登录校验的时候一并校验。
• 如何保护 Web 服务？ 针对 IP 限流、整个集群限流。后续你还会接触到更加多的保护措施。
注意：这一部分的内容在你们面试初级工程师的时候，是属于比较有技术含量的点了，你在面试前一定
要试着按照自己的说话习惯，整理好对应的答案，写出来多读几遍。

## 如何在测试中维护登录态

你有两条思路：
• 在测试初始化的时候去模拟登录，拿到对应的登录态的数据，例如 JWT token 或者 session id。
• 直接手动登录，然后复制对应的 token 或者 cookie 的值到脚本中，运行测试。
如果你的测试里面有权限控制，那么需要使用一个特殊的用户，这个用户有所有的权限。

## 理论

这一节课相关的面试内容都是纯理论：
• 什么是依赖注入？如何在 Go 里面是实现依赖注入？
• 什么是面向接口编程？为什么要面向接口编程？
• 什么是 IoC（控制反转）？
面试不需要太紧张，因为差不多就是问问基本概念。这一类纯理论的面试难点在于，我作为面试官也不
知道怎么面你。

# 项目

## **设计并实现一个 Gin 插件库**

Gin 本身的 middleware 机制可以做到非常多的事情，包括：
• Web 治理：熔断限流降级等
• 可观测性：包括日志、metrics、tracing
• 身份认证与鉴权：我们这一节课已经接触到了登录校验，算是一个比较简单的实现
• ……
在中小型公司里面，可能都是直接使用开源的 Gin 插件实现，但是你可以考虑改成自研的。后续我们会陆
续讲到其它内容。你现在要做的是，先把这个仓库建起来，然后写好第一个登录校验的插件。
自研的好处是：可以针对你们公司的规范、基础设施来定制。
而后你同样可以把这个仓库开源出去，证明你熟练使用 Gin。

## 保护公司前端接口

检查公司的前端接口，而后加入限流功能。
• 可以考虑整个集群限流
• 针对核心业务的接口限流
• 针对不需要登录就可以访问的接口限流
• 为限流添加对应的监控和告警

## Gin 插件库添加限流插件

为 Gin 插件库添加限流插件，包含：
• 单机限流
• 令牌桶算法
• 漏桶算法
• 滑动窗口算法
• 固定窗口算法
• 基于 Redis 限流
• 基于 Redis 的 IP 限流

## 如何实现一个验证码登录功能

你的回答要分成以下几个部分：
• 简要说明验证码流程的基本步骤。
• 详细说明如何保护系统，即防止黑客恶意发送短信，增大成本支出，也要防止验证码被暴力破解。
• 重点说明验证码发送/验证流程，强调里面的并发问题，并如何使用 lua 脚本来解决并发问题。
衍生出来的问题有：
• 能不能让用户在输入错误的验证码后继续重试？

可以，但限制次数比如3次

• 为什么要控制验证码的发送频率？你可以怎么控制？

防止暴力破解

• 如果我在前端加了一个限流措施，能不能保护住我的系统？有什么问题？

不能，黑客利用脚本直接向后端发请求

**验证码加密（可选）**
注意，目前我们在 Redis 中存储的验证码都是明文存储的。但是验证码本身作为一个非常关键的数据，
明文存储是不安全的（主要是防你的同事）。
因此你要做的就是，用合适的加密算法来加密验证码，并且保证整个过程依旧非常流畅。

# k8s

当你出去面试业务研发岗位的时候，Kubernetes 的面试就是集中在一些基本概念上：
• Kubernetes 中的 apiVersion 是什么意思？
• Kubernetes 中 Service、Deployment 和 Pod 的基本概念，能用来干什么？
• Service 的类型有哪几种？有什么区别？用在什么场景？
• 什么是 ingress？ingress 和 ingress-controller 是什么关系？
• PersistentVolume 和 PersistentVolumeClaim 是什么关系？为什么要有这两个？
• accessMode 有哪些取值？分别是什么含义？
正常你在入职一家公司之后，也仅仅是掌握编写 K8s 的配置文件就可以了。